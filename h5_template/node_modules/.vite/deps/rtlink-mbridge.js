import "./chunk-PZ5AY32C.js";

// node_modules/rtlink-mbridge/dist/index.mjs
var package_default = {
  name: "rtlink-mbridge",
  version: "0.26.0",
  description: "",
  main: "index.js",
  module: "./dist/index.mjs",
  types: "./dist/index.d.ts",
  exports: {
    ".": {
      import: "./dist/index.mjs",
      require: "./dist/index.js",
      types: "./dist/index.d.ts"
    }
  },
  files: ["dist"],
  scripts: {
    test: 'echo "Error: no test specified" && exit 1',
    build: "tsup src/index.ts --format cjs,esm --dts"
  },
  keywords: [],
  author: "",
  license: "ISC",
  devDependencies: {
    tsup: "^8.5.1",
    typescript: "^5.9.3"
  }
};
var fnSpliter = "|rtm|";
function isIOS() {
  const ua = navigator.userAgent.toLowerCase();
  if (/iphone|ipad|ipod/.test(ua)) {
    return true;
  }
  if (navigator.platform === "MacIntel" && navigator.maxTouchPoints > 1) {
    return true;
  }
  if (navigator.platform.includes("iPhone") || navigator.platform.includes("iPad")) {
    return true;
  }
  return false;
}
function isAndroid() {
  if (typeof navigator === "undefined") return false;
  return /android/i.test(navigator.userAgent);
}
var postDataToiOS = (data) => {
  var _a, _b;
  const dataType = typeof data;
  let _data;
  if (dataType == "object") {
    _data = JSON.stringify(data);
  } else {
    _data = data;
  }
  try {
    (_b = (_a = window.webkit) == null ? void 0 : _a.messageHandlers) == null ? void 0 : _b.swiftHandler.postMessage(_data);
  } catch (err) {
    console.error(err);
  }
};
var getDeviceInfo = async () => {
  return new Promise((resolve) => {
    postDataToiOS(`getDeviceInfo`);
    window.rtmobile.callbacks.afterGetDeviceInfo = resolve;
  });
};
var writeLocal = async (key, value, seconds) => {
  return new Promise((resolve) => {
    postDataToiOS(`writeLocal${fnSpliter}${key}${fnSpliter}${value}${fnSpliter}${seconds}`);
    window.rtmobile.callbacks.afterWriteLocal = resolve;
  });
};
var readLocal = async (key) => {
  return new Promise((resolve) => {
    postDataToiOS(`readLocal${fnSpliter}${key}`);
    window.rtmobile.callbacks.afterReadLocal = resolve;
  });
};
var preDial = async (number) => {
  postDataToiOS(`preDial${fnSpliter}${number}`);
};
var checkoutNetwork = async () => {
  return new Promise((resolve) => {
    postDataToiOS(`checkoutNetwork`);
    window.rtmobile.callbacks.afterCheckoutNetwork = resolve;
  });
};
var setScreenHorizontal = async () => {
  return new Promise((resolve) => {
    postDataToiOS(`setScreenHorizontal`);
    setTimeout(() => {
      resolve();
    }, 300);
  });
};
var setScreenPortrait = async () => {
  return new Promise((resolve) => {
    postDataToiOS(`setScreenPortrait`);
    setTimeout(() => {
      resolve();
    }, 300);
  });
};
var scan = async () => {
  return new Promise((resolve) => {
    postDataToiOS(`scan`);
    window.rtmobile.callbacks.afterScan = resolve;
  });
};
var getDeviceInfo2 = async () => {
  return new Promise((resolve) => {
    window.Android.getDeviceInfo();
    window.rtmobile.callbacks.afterGetDeviceInfo = resolve;
  });
};
var writeLocal2 = async (key, value, seconds) => {
  return new Promise((resolve) => {
    window.Android.writeLocal(key, `${value}`, seconds);
    window.rtmobile.callbacks.afterWriteLocal = resolve;
  });
};
var readLocal2 = async (key) => {
  return new Promise((resolve) => {
    window.Android.readLocal(key);
    window.rtmobile.callbacks.afterReadLocal = resolve;
  });
};
var preDial2 = async (number) => {
  window.Android.preDial(number);
};
var checkoutNetwork2 = async () => {
  return new Promise((resolve) => {
    window.Android.checkoutNetwork();
    window.rtmobile.callbacks.afterCheckoutNetwork = resolve;
  });
};
var setScreenHorizontal2 = async () => {
  return new Promise((resolve) => {
    window.Android.setScreenHorizontal();
    setTimeout(() => {
      resolve();
    }, 300);
  });
};
var setScreenPortrait2 = async () => {
  return new Promise((resolve) => {
    window.Android.setScreenPortrait();
    setTimeout(() => {
      resolve();
    }, 300);
  });
};
var scan2 = async () => {
  return new Promise((resolve) => {
    window.Android.scan();
    window.rtmobile.callbacks.afterScan = resolve;
  });
};
var rtm = {
  // 初始化铺垫
  init() {
    const color1 = "#1e90ff";
    const color2 = "#fff";
    console.log(
      `%c rtlink-mbridge %c v${package_default.version} `,
      `background:${color1}; color:${color2}; padding:2px 4px; border-radius:4px 0 0 4px; border: solid 1px ${color1};`,
      `background:${color2}; color:${color1}; padding:2px 4px; border-radius:0 4px 4px 0; border: solid 1px ${color1};`
    );
    if (!window.rtmobile) {
      window.rtmobile = {
        version: package_default.version,
        callbacks: {}
      };
    }
  }
};
var index_default = rtm;
var getDeviceInfo3 = async () => {
  if (isIOS()) {
    return getDeviceInfo();
  } else if (isAndroid()) {
    return getDeviceInfo2();
  } else {
    return Promise.resolve("X");
  }
};
var writeLocal3 = async (key, value, seconds) => {
  const validityPeriod = 3600 * 24 * 365 * 99;
  if (isIOS()) {
    return writeLocal(key, value, seconds ?? validityPeriod);
  } else if (isAndroid()) {
    return writeLocal2(key, value, seconds ?? validityPeriod);
  } else {
    return Promise.resolve("X");
  }
};
var readLocal3 = async (key) => {
  if (isIOS()) {
    return readLocal(key);
  } else if (isAndroid()) {
    return readLocal2(key);
  } else {
    return Promise.resolve("X");
  }
};
var preDial3 = async (number) => {
  if (isIOS()) {
    return preDial(number);
  } else if (isAndroid()) {
    return preDial2(number);
  } else {
    return;
  }
};
var checkoutNetwork3 = async () => {
  if (isIOS()) {
    return checkoutNetwork();
  } else if (isAndroid()) {
    return checkoutNetwork2();
  } else {
    return Promise.resolve("X");
  }
};
var setScreenHorizontal3 = async () => {
  if (isIOS()) {
    return setScreenHorizontal();
  } else if (isAndroid()) {
    return setScreenHorizontal2();
  } else {
    return Promise.resolve();
  }
};
var setScreenPortrait3 = async () => {
  if (isIOS()) {
    return setScreenPortrait();
  } else if (isAndroid()) {
    return setScreenPortrait2();
  } else {
    return Promise.resolve();
  }
};
var scan3 = async () => {
  if (isIOS()) {
    return scan();
  } else if (isAndroid()) {
    return scan2();
  } else {
    return Promise.resolve("X");
  }
};
export {
  checkoutNetwork3 as checkoutNetwork,
  index_default as default,
  getDeviceInfo3 as getDeviceInfo,
  isAndroid,
  isIOS,
  preDial3 as preDial,
  readLocal3 as readLocal,
  scan3 as scan,
  setScreenHorizontal3 as setScreenHorizontal,
  setScreenPortrait3 as setScreenPortrait,
  writeLocal3 as writeLocal
};
//# sourceMappingURL=rtlink-mbridge.js.map
